<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inconsolata&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <title>Document</title>
  </head>
  <body style="width: 100vw">
    <div class="backtoblogs">
      <a
        href="index.html"
        style="color: #64ffda; text-decoration: none; font-family: inconsolata"
        >Back to Blogs</a
      >
    </div>

    <div class="blogcontent" id="blogcontent"></div>

    <div class="postactivity">
      <p id="likecount" style="color: white">0</p>
      <img src="whitelike.png" alt="" id="whitelike" />
      <!-- <p id="commentcount" style="color: white;padding-left: 15px;"></p> -->
      <!-- <img src="comments.png" alt="" id="commentpost"> -->
    </div>
    <!-- <div class="relatedarticles" >

        <h2><u>Other Related Articles</u></h2>
        <ul style="list-style-type: decimal;">
            <li>Integrating Algolia Search with Wordpress Multisite.</li>
            <li>Integrating Algolia Search with Wordpress Multisite.</li>
            <li>Integrating Algolia Search with Wordpress Multisite.</li>
            <li>Integrating Algolia Search with Wordpress Multisite.</li>

        </ul>

    </div>
    <div class="advert">
        <h2>Advert</h2>
        <div class="advert-content">

        </div> -->

    <div class="comment">
      <h2 id="comments_title">Comments</h2>
      <form
        name="commentform"
        id="commentform"
        onsubmit="validate(); return false; "
      >
        <input type="text" id="commentorname" placeholder="Add Name" /><br />
        <span
          id="commentorname_error"
          style="visibility: visible; color: red; font-family: 'inconsolata'"
        ></span
        ><br />
        <input
          type="text"
          id="comment"
          name="comment"
          placeholder="Leave a Comment"
        /><br />
        <p
          id="comment_error"
          style="visibility: hidden; color: red; font-family: 'inconsolata'"
        >
          Comment required
        </p>
        <button id="submit_comment" type="submit">Comment</button>
      </form>
    </div>
    <div id="commentssection"></div>

    <script>
      const href = new URL(location.href);
      const blogId = href.hash.replace('#', '');
      document
        .getElementById('whitelike')
        .addEventListener('click', function (e) {
          likecount = document.getElementById('likecount');
          var likecounter = document.getElementById('likecount').value;
          likecounter = 0;
          var img = e.target;
          if (img.id === 'whitelike') {
            likecounter++;

            img.src = 'blacklikebutton.png';
            img.id = 'blacklike';
          } else if (img.id === 'blacklike') {
            img.src = 'whitelike.png';
            img.id = 'whitelike';
          }
          likecount.innerHTML = `${likecounter}`;
        });

      // function validate() {
      //     if(document.commentform.comment.value==""){
      //         comment_error.style.visibility="visible";
      //         comment.style.border="solid 2px red";

      //     }
      //      if(document.commentform.commentorname.value==""){
      //         commentorname.style.border="solid 2px red";

      //         commentorname_error.innerHTML="Name is required";
      //     }
      //      if(document.commentform.commentorname.value.length>0 && document.commentform.commentorname.value.length<2){
      //         commentorname.style.border="solid 2px red";
      //         commentorname_error.innerHTML="Name is too short";

      //     }

      //     if(document.commentform.commentorname.value.length>1 ){
      //         comment_error.style.visibility="hidden";
      //         comment.style.border="solid 1px #64ffda";
      //         commentorname.style.border="solid 2px #64ffda";
      //         commentorname_error.innerHTML="";
      //     }
      //     if(document.commentform.comment.value.length>0 ){
      //         comment.style.border="solid 1px #64ffda";
      //         comment_error.style.visibility="hidden";

      //     }
      // }

      // document.getElementById('submit_comment').addEventListener('click',function(){
      //     var name=document.getElementById('commentorname').value;
      //     var commentcontent=document.getElementById('comment').value;
      //     var comment={
      //     name:name,
      //     comment:commentcontent

      // }
      // var comments;
      //     if(name&&comment){
      //         if(localStorage.getItem("comments")){
      //             comments=JSON.parse(localStorage.getItem('comments'))
      //             comments.push(comment);
      //         }
      //         else{
      //             comments=[];
      //             comments.push(comment);
      //         }
      //     localStorage.setItem('comments',JSON.stringify(comments))

      //     }

      // location.reload();

      // })

      // function fetchBlog(){
      //    blogs=JSON.parse(localStorage.getItem("blogs"));
      //   var blogcontent=document.getElementById("blogcontent");

      // // If there are no Blogs in Local Storage
      //     if (!blogs) {

      //     document.querySelector("#blogcontent").innerHTML = "No blog posts available.";

      // }
      // // Incase there are Blogs
      // else{
      //     for( let i=0;i<blogs.length;i++){
      //         var title=blogs[i].title;
      //     var summary=blogs[i].summary;
      //     var content=blogs[i].content
      //     var resources=blogs[i].resources;
      //     var cover=blogs[i].coverimage;
      //     blogcontent.innerHTML=`    <div class="title">
      //                             <h2><u>${title}</u></h2></div>
      //                             </div>
      //                                 <div class="paragraphs">
      //                                 ${content}
      //                                 </div>
      //                             </div>`;
      //         }

      //  }

      // }

      async function getBlogs() {
        let url = `https://my-api-kiyi.onrender.com/api/blogs`;

        try {
          let res = await fetch(url);
          return await res.json();
        } catch (error) {
          console.log(error);
        }
      }

      //   async function getBlogById(id) {
      //     let url = `https://my-api-kiyi.onrender.com/api/blogs/${id}`;

      //     try {
      //       let res = await fetch(url);
      //       return await res.json();
      //     } catch (error) {
      //       console.log(error);
      //     }
      //   }

      async function renderSingleBlog() {
        console.log(getBlogs());
        let blogs = await getBlogs();
        console.log(blogs);
        const currentBlog = blogs.filter(({ _id }) => _id == blogId);
        let html = '';
        if (currentBlog) {
          currentBlog.map((blog) => {
            let htmlSegment = `<div class="title">
                            <h2><u>${blog.title}</u></h2></div>
                            </div>
                                <div class="paragraphs">
                                ${blog.content}
                                </div>
                            </div>`;
            html += htmlSegment;
          });
        }

        var blogcontent = document.getElementById('blogcontent');
        blogcontent.innerHTML = html;
      }
      renderSingleBlog();

      // fetchBlog();

      function fetchComments(){

         var commentsec=document.getElementById("commentssection");

         comments=JSON.parse(localStorage.getItem("comments"));

              if(!comments){
                 document.querySelector('#commentssection').innerHTML='No Comments'
              }
              else{

                  for(let i=0;i<comments.length;i++){
              var name=comments[i].name;
              var comment=comments[i].comment;

                  commentsec.innerHTML +=`
                  <div class="UserComments" onclick>

                  <img src="Portfolio picture.jpg">
                  <h4>${name}</h4>
                  <p>${comment}</p>
                              <h5 style="font-weight: 10;">21.December.2022  .</h5>
                  <h5 style="font-weight: 10;">2 hours ago</h5>
                                   </div>`
              }
          }
          };

      fetchComments();
    </script>
  </body>
</html>
